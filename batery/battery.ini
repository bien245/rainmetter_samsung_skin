[Rainmeter]
Update=50
DynamicWindowSize=1
AccurateText=1
BackgroundMode=2
SolidColor=32,32,32,255

[Variables]
; Màu sắc
TextColor=255,255,255,255
CircleColor=0,255,128,255    ; Màu xanh lá cây như trong ảnh
CircleBG=64,64,64,100       ; Màu xám đậm cho background
CircleWidth=15
CircleSize=100
CircleX=60
CircleY=60

; Tính toán bán kính và vị trí đầu cuối thanh
Radius=(#CircleSize#/2)
CapRadius=(#CircleWidth#/2)
ArcRadius=(#Radius# - #CircleWidth#/2)

; Vòng cung cân bằng đối xứng (216°)
ArcLength=3.770  ; 216° = 3.770 radian
; Cân bằng: 270° - 108° = 162° đến 270° + 108° = 378° (18°)
StartAngleBalance=2.827  ; 162° (cân bằng)
EndAngleBalance=6.597    ; 378° = 18° (cân bằng)

; Tính toán vị trí đầu thanh cố định
StartCapX=(#CircleX# + #ArcRadius# * cos(2.827))
StartCapY=(#CircleY# + #ArcRadius# * sin(2.827))

; Tính toán vị trí cuối thanh động (theo % pin)
EndCapAngle=(2.827 + 3.770 * [MeasureBattery] / 100)
EndCapX=(#CircleX# + #ArcRadius# * cos(#EndCapAngle#))
EndCapY=(#CircleY# + #ArcRadius# * sin(#EndCapAngle#))

; Font chữ
FontFace=Segoe UI
FontSize=10
FontSizeLarge=20
FontSizeSmall=8

[MeasureBattery]
Measure=Plugin
Plugin=PowerPlugin
PowerState=PERCENT
MinValue=0
MaxValue=100
OnChangeAction=[!UpdateMeter *][!Redraw]

[MeasureBatteryStatus]
Measure=Plugin
Plugin=PowerPlugin
PowerState=STATUS
Substitute="0":"Đang dùng","1":"Đang sạc","2":"Đầy"

[StyleText]
FontColor=#TextColor#
FontFace=#FontFace#
StringStyle=Bold
StringEffect=Shadow
FontEffectColor=0,0,0,50
AntiAlias=1

[StyleCenter]
StringAlign=Center
StringCase=None

[BackgroundArc]
Meter=Roundline
X=(#CircleX# - #Radius#)
Y=(#CircleY# - #Radius#)
W=#CircleSize#
H=#CircleSize#
LineWidth=#CircleWidth#
LineLength=#Radius#
LineStart=(#Radius# - #CircleWidth#)
LineColor=#CircleBG#
RotationAngle=3.770   ; 216° cân bằng
StartAngle=2.827      ; Bắt đầu từ 162° (cân bằng)
AntiAlias=1
Solid=1

; Hình tròn đầu thanh nền
[BackgroundStartCap]
Meter=Shape
Shape=Ellipse #StartCapX#,#StartCapY#,#CapRadius# | Fill Color #CircleBG# | StrokeWidth 0
DynamicVariables=1

; Hình tròn cuối thanh nền (vị trí cố định ở cuối cung)
[BackgroundEndCap]
Meter=Shape
Shape=Ellipse (#CircleX# + #ArcRadius# * cos(0.314)),(#CircleY# + #ArcRadius# * sin(0.314)),#CapRadius# | Fill Color #CircleBG# | StrokeWidth 0
DynamicVariables=1


[ProgressArc]
Meter=Roundline
MeasureName=MeasureBattery
X=(#CircleX# - #Radius#)
Y=(#CircleY# - #Radius#)
W=#CircleSize#
H=#CircleSize#
LineWidth=#CircleWidth#
LineLength=#Radius#
LineStart=(#Radius# - #CircleWidth#)
LineColor=#CircleColor#
RotationAngle=3.770   ; 216° cân bằng
StartAngle=2.827      ; Bắt đầu từ 162° (cân bằng)
MinValue=0
MaxValue=100
AntiAlias=1
Solid=1

; Hình tròn đầu thanh tiến trình
[ProgressStartCap]
Meter=Shape
Shape=Ellipse #StartCapX#,#StartCapY#,#CapRadius# | Fill Color #CircleColor# | StrokeWidth 0
DynamicVariables=1

; Hình tròn cuối thanh tiến trình (đi chuyển theo % pin)
[ProgressEndCap]
Meter=Shape
MeasureName=MeasureBattery
Shape=Ellipse ([MeasureBattery] > 0 ? (#CircleX# + #ArcRadius# * cos(2.827 + 3.770 * [MeasureBattery] / 100)) : -100),([MeasureBattery] > 0 ? (#CircleY# + #ArcRadius# * sin(2.827 + 3.770 * [MeasureBattery] / 100)) : -100),#CapRadius# | Fill Color #CircleColor# | StrokeWidth 0
DynamicVariables=1


; Icon pin - ảnh Group 3.png (nằm giữa vòng cung)
[BatteryIcon]
Meter=Image
ImageName=#@#Group 3.png
X=(#CircleX# - 20)
Y=(#CircleY# - 20)
W=40
H=40
PreserveAspectRatio=1
AntiAlias=1

; Phần trăm pin (nằm phía dưới)
[BatteryPercent]
Meter=String
MeterStyle=StyleText | StyleCenter
MeasureName=MeasureBattery
X=#CircleX#
Y=(#CircleY# + 20)
FontSize=20
FontWeight=700
Text="%1"
FontColor=255,255,255,255

; Tên thiết bị (có giới hạn chiều rộng)
[BatteryStatus]
Meter=String
MeterStyle=StyleText | StyleCenter
X=#CircleX#
Y=(#CircleY# + 50)
W=80
H=20
FontSize=12
Text="PC"
FontColor=255,255,255,255
ClipString=1
